<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.my.shop.web.admin.dao.TbContentMapper">
  <resultMap id="BaseResultMap" type="com.example.my.shop.domain.TbContent">
    <!--@mbg.generated-->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="category_id" jdbcType="BIGINT" property="categoryId" />
    <result column="title" jdbcType="VARCHAR" property="title" />
    <result column="sub_title" jdbcType="VARCHAR" property="subTitle" />
    <result column="title_desc" jdbcType="VARCHAR" property="titleDesc" />
    <result column="url" jdbcType="VARCHAR" property="url" />
    <result column="pic" jdbcType="VARCHAR" property="pic" />
    <result column="pic2" jdbcType="VARCHAR" property="pic2" />
    <result column="content" jdbcType="LONGVARCHAR" property="content" />
    <result column="created" jdbcType="TIMESTAMP" property="created" />
    <result column="updated" jdbcType="TIMESTAMP" property="updated" />

    <association property="tbContentCategory" javaType="TbContentCategory">
      <!--<id column="id" jdbcType="BIGINT" property="id"/>-->
      <result column="name" jdbcType="VARCHAR" property="name"/>
    </association>


  </resultMap>
  <sql id="Base_Column_List">
    <!--@mbg.generated-->
    a.id,
    a.category_id,
    a.title,
    a.sub_title,
    a.title_desc,
    a.url,
    a.pic,
    a.pic2,
    a.content,
    a.created,
    a.updated,
    b.name
  </sql>

  <sql id="Left_Joins">
    LEFT JOIN tb_content_category b ON a.category_id = b.id
  </sql>

  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--@mbg.generated-->
    select 
    <include refid="Base_Column_List" />
    from tb_content AS a
    <include refid="Left_Joins"/>
    where a.id = #{id,jdbcType=BIGINT}
  </select>

  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--@mbg.generated-->
    delete from tb_content
    where id = #{id,jdbcType=BIGINT}
  </delete>

  <insert id="insert" keyColumn="id" keyProperty="id" parameterType="com.example.my.shop.domain.TbContent" useGeneratedKeys="true">
    <!--@mbg.generated-->
    insert into tb_content (category_id, title, sub_title,
      title_desc, url, pic, 
      pic2, content, created, 
      updated)
    values (#{categoryId,jdbcType=BIGINT}, #{title,jdbcType=VARCHAR}, #{subTitle,jdbcType=VARCHAR},
      #{titleDesc,jdbcType=VARCHAR}, #{url,jdbcType=VARCHAR}, #{pic,jdbcType=VARCHAR}, 
      #{pic2,jdbcType=VARCHAR}, #{content,jdbcType=LONGVARCHAR}, #{created,jdbcType=TIMESTAMP}, 
      #{updated,jdbcType=TIMESTAMP})
  </insert>

  <update id="updateByPrimaryKey" parameterType="com.example.my.shop.domain.TbContent">
    <!--@mbg.generated-->
    update tb_content
    set category_id = #{categoryId,jdbcType=BIGINT},
      title = #{title,jdbcType=VARCHAR},
      sub_title = #{subTitle,jdbcType=VARCHAR},
      title_desc = #{titleDesc,jdbcType=VARCHAR},
      url = #{url,jdbcType=VARCHAR},
      pic = #{pic,jdbcType=VARCHAR},
      pic2 = #{pic2,jdbcType=VARCHAR},
      content = #{content,jdbcType=LONGVARCHAR},
      created = #{created,jdbcType=TIMESTAMP},
      updated = #{updated,jdbcType=TIMESTAMP}
    where id = #{id,jdbcType=BIGINT}
  </update>

<!--auto generated by MybatisCodeHelper on 2019-05-09-->
  <select id="selectAll" resultMap="BaseResultMap" parameterType="java.util.Map">
        select
        <include refid="Base_Column_List"/>
        from tb_content AS a
        <include refid="Left_Joins"/>
    <where>
      <choose>
        <when test="flag == true and fuzzy != '' ">
          a.title like concat ('%',#{fuzzy},'%')
          or a.sub_title like concat ('%',#{fuzzy},'%')
          or a.title_desc like concat ('%',#{fuzzy},'%')
        </when>
        <otherwise>
          <if test="title != null and title !=''">
            and a.title like concat ('%',#{title},'%')
          </if>
          <if test="subTitle != null and subTitle !=''">
            and a.sub_title like concat ('%',#{subTitle},'%')
          </if>
          <if test="titleDesc != null and titleDesc !=''">
            and a.title_desc like concat ('%',#{titleDesc},'%')
          </if>
        </otherwise>
      </choose>
    </where>

  </select>

  <delete id="deleteMulti">
    <!-- select * from student where id in (2, 4) -->
    delete FROM tb_content
    WHERE id IN
    <foreach collection="array" open="(" close=")" item="id" separator=",">
      #{id}
    </foreach>
  </delete>

  <delete id="deleteByCategoryId" parameterType="java.lang.Long">
    <!--@mbg.generated-->
    delete from tb_content
    where category_id = #{categoryId,jdbcType=BIGINT}
  </delete>

</mapper>